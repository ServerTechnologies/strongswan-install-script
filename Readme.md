# Скрипт для автоматического создания VPN IKEv2 с помощью демона Strongswan.
Этот скрипт предназначен для автоматической установки демона Strongswan. Используйте Ubuntu 22.04, на ней этото скипт протестирован и работает хорошо.

## VPS для панели.
Для установки панели нам понадобится VPS сервер. Приобрести его можно в <a href="https://bit.ly/3rOqvPE)" target="_blank">ishosting (ссылка)</a>.
В сервисе доступны 36+ локаций. Если вам не нужна какая-то конкретная страна, то выбирайте ту что ближе к вам.

## Установка.
### Обновите списки репозиториев и установленные пакеты
```
sudo apt update
sudo apt upgrade -y
```

В процессе вы увидите несколько подобных окон, просто жмите Enter.
Примеры окон:


После окончания обновления перезагрузите сервер следующей командой:
```
sudo reboot
```

Соединение с сервером оборвется, так как он ушел в перезагрузку. Подождите пару минут и подключитесь снова.

### Устанеовка скрипта
Скачайте скрипт
```
wget https://raw.githubusercontent.com/ServerTechnologies/strongswan-install-script/refs/heads/main/startswan.sh
```
Перед запуском скрипта узнайте свой сетевой интерфейс, используя команду
```
ip route show default
```
После применения команды вы увидите вывод вида
```
Output
default via your_server_ip dev eth0  proto static
```
После **dev** будет нужный интерфейc, в данном случае это **eth0**. Вставьте в скрипте ваш интерфейс, используйте поиск для этого. Замените в скрипте все eth0 на ваш сетевой интерфейс.\
Для запуска скрипта используйте команду
```
yes | sudo sh startswan.sh
```


## Использование.

Вам нужно будет добавить логин и пароль пользователя.\
Для этого отредактируйте файл.
```
sudo nano /etc/ipsec.secrets
```
Внутри файла есть шаблон добавления нового пользователя. Чтобы сохранить изменения и выйти, используйте сочетание клавиш CTRL+X и введите "y"\
Перезагрузите Strongswan после сохранения файла, используя команду
```
sudo systemctl restart strongswan-starter
```

Получите сертефикат с помошью команды
```
cat /etc/ipsec.d/cacerts/ca-cert.pem
```
Сохраните текст, заключенный между
</br>**-----BEGIN CERTIFICATE-----** и **-----END CERTIFICATE-----**</br>
на локальный компьютер, включая эти две строки в файл с расширением **.pem**

## Важные дополнения.
### Про файервол
Этот скрипт устанавливает и запускает файервол ufw. Это значит, что любые приложения на сервере прекратят отвечать на любые вызовы, до тех пор пока вы не откроете порты, используемые этими приложениями. Сделать это можно с помощью этой команды:
```
ufw allow port
```

Вместо port вставьте номер нужного порта. Например, если нужно открыть порт 443, команда будет выглядеть так:
```
ufw allow 443
```

Скрипт автоматически открывает стандартный порт ssh. Если вы меняли порт, не забудьте открыть его перед закрытием сессии.

### Про ускорение YouYube.
ВПН - это средство построение приватных сетей и шифрования трафика в целях безопасности, а не метод решения технических проблем с износом инфраструктуры Google. VPN IKEv2 очень легко блокируется в случае необходимости, поэтому может быть такое что вы захотите посмотреть ютюбчик, а у РКН будут другие планы на ваш досуг. Поэтому можете на тот же сервер накатить 3x-ui, вот ссылка на инструкцию с обновлениями:\
https://github.com/ServerTechnologies/youtube-instructions/blob/main/3x-ui-settings.md
\
И на видео:
https://youtu.be/gJNkZKRrKnk

Только не забудьте в файерволе открыть порты которые использует панель и 443 порт